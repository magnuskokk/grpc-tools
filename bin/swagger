#!/bin/bash

# Remove old doc
rm -rf ./swagger

# Create swagger dir if not exists
mkdir -p ./swagger

# Install swagger-ui-dist static files
npm install --prefix $GOPATH -g swagger-ui-dist

# Copy the swagger ui dist from node package dir
cp -r ${GOPATH}/lib/node_modules/swagger-ui-dist/* ./swagger/

# Replace the default example with our own service documentation
sed -i -e 's/https:\/\/petstore.swagger.io\/v2\/swagger.json/http:\/\/localhost:8000\/openapi-ui\/pkg\/server\/service.swagger.json/g' ./swagger/index.html

# Pack the doc web application into single file
statik -m -f -src ./swagger
